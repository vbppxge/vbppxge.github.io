ä½œè€…ï¼šé«˜å¯’è•Šï¼ŒGoogle å¼€å‘æŠ€æœ¯æ¨å¹¿å·¥ç¨‹å¸ˆ

> **Google Play Billing ç³»åˆ—å†…å®¹**æ˜¯ä¸“é—¨ä¸ºä¸­æ–‡å¼€å‘è€…å¼€è¾Ÿçš„ç³»åˆ—åˆ†äº«ï¼Œç€é‡è®²è§£ä¸­å›½å¼€å‘è€…å¯¹ Play Billing æœ€å®¹æ˜“æ„Ÿåˆ°ç–‘æƒ‘çš„åœ°æ–¹ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ï¼Œä¹Ÿæ¬¢è¿åœ¨ç•™è¨€åŒºæå‡ºï¼Œæˆ‘ä»¬ä¼šæ”¶é›†å¤§å®¶çš„åé¦ˆå¹¶åœ¨åç»­æ–‡ç« ä¸­åšå‡ºè§£ç­”ã€‚

## æ¢å¤è®¢é˜…ä¸é‡æ–°è®¢é˜…çš„åŒºåˆ«

ä½œä¸ºè®¢é˜…åº”ç”¨çš„å¼€å‘è€…ï¼Œæ‚¨å¯èƒ½å·²ç»äº†è§£è®¢é˜…ä¸šåŠ¡æ¨¡å¼å¯¹åº”ç”¨å’Œæ¸¸æˆç›ˆåˆ©çš„é‡è¦æ€§ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ç”¨æˆ·å–æ¶ˆè®¢é˜…åçš„ä¸¤ç§æ“ä½œæ–¹å¼â€”â€”**æ¢å¤è®¢é˜…**å’Œ**é‡æ–°è®¢é˜…**ï¼Œå¹¶åˆ†æå®ƒä»¬çš„åŒºåˆ«åŠæ³¨æ„äº‹é¡¹ã€‚

### æ¢å¤è®¢é˜…ï¼ˆRestoreï¼‰

æ¢å¤è®¢é˜…çš„é‡ç‚¹åœ¨äºâ€œæ¢å¤â€ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªå…³é”®æ¡ä»¶ï¼š
1. ç”¨æˆ·å·²å–æ¶ˆè®¢é˜…ï¼›
2. è®¢é˜…å°šæœªè¿‡æœŸï¼›
3. åªèƒ½åœ¨ Play è®¢é˜…ä¸­å¿ƒæ“ä½œã€‚

ç”±äºæ˜¯æ¢å¤æ“ä½œï¼Œè®¢é˜…å®é™…ä¸Šè¿˜æ˜¯åŸæ¥çš„ï¼Œ`purchaseToken` ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚

### é‡æ–°è®¢é˜…ï¼ˆResubscribeï¼‰

é‡æ–°è®¢é˜…æœ¬è´¨ä¸Šæ˜¯ä¸€æ¬¡æ–°çš„è®¢é˜…è´­ä¹°ï¼Œç‰¹ç‚¹å¦‚ä¸‹ï¼š
- é€‚ç”¨äºå·²è¿‡æœŸçš„è®¢é˜…ï¼›
- ç”¨æˆ·å¯ä»¥ä»åº”ç”¨å†…æˆ– Play è®¢é˜…ä¸­å¿ƒå‘èµ·æ“ä½œï¼›
- é‡æ–°è®¢é˜…ä¼šç”Ÿæˆæ–°çš„ `purchaseToken`ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè®¢é˜…è¿‡æœŸè¶…è¿‡ä¸€å¹´ï¼Œç”¨æˆ·åªèƒ½é€šè¿‡æ‚¨çš„åº”ç”¨é‡æ–°è´­ä¹°ã€‚

### ä¸¤è€…çš„å¯¹æ¯”

ä»¥ä¸‹è¡¨æ ¼ç›´è§‚å±•ç¤ºäº†æ¢å¤è®¢é˜…ä¸é‡æ–°è®¢é˜…çš„ä¸»è¦åŒºåˆ«ï¼š

![æ¢å¤è®¢é˜…ä¸é‡æ–°è®¢é˜…å¯¹æ¯”](http://p7.itc.cn/q_70/images03/20200821/78892519fcd646a6b43d6d7f8b563be9.png)

### ç‰¹æ®Šåœºæ™¯æé†’

å½“ç”¨æˆ·å–æ¶ˆçš„è®¢é˜…å°šæœªåˆ°æœŸï¼Œåˆå†æ¬¡è´­ä¹°æ—¶ï¼š
- æ–°è®¢é˜…å°†æ›¿æ¢æ—§è®¢é˜…ï¼Œå¹¶åœ¨åŒä¸€åˆ°æœŸæ—¥æœŸç»­è®¢ï¼›
- é‡æ–°è®¢é˜…ä¼šç”Ÿæˆæ–°çš„ `purchaseToken`ï¼Œè€Œæ—§çš„ `purchaseToken` ä»ç„¶æœ‰æ•ˆã€‚

å¼€å‘è€…éœ€è¦åŠæ—¶å°†æ—§çš„ `purchaseToken` æ ‡æ³¨ä¸ºå¤±æ•ˆï¼Œä»¥é¿å…åŒä¸€ç”¨æˆ·å¯¹åŒä¸€è®¢é˜…äº§å“ï¼ˆSKUï¼‰æ‹¥æœ‰å¤šä¸ªæœ‰æ•ˆçš„ `purchaseToken`ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥é€šè¿‡æ–°çš„è®¢é˜…ä¸­çš„ `linkedPurchaseToken` å­—æ®µæ‰¾åˆ°æ—§çš„ `purchaseToken`ã€‚

> **æ³¨æ„**ï¼šä¸è¦ä¾èµ– `linkedPurchaseToken` å­—æ®µæ¥åˆ¤æ–­æ—§è®¢é˜…æ˜¯å¦ä»åœ¨æœ‰æ•ˆæœŸå†…ã€‚è¯·å§‹ç»ˆé€šè¿‡ Google Developer API çš„ `expiryTimeMillis` å­—æ®µè·å–è®¢é˜…çš„æ­£ç¡®åˆ°æœŸæ—¶é—´ã€‚

## å¼€å‘è€…éœ€è¦æ³¨æ„çš„äº‹é¡¹

1. **åŠæ—¶ç¡®è®¤è´­ä¹°äº¤æ˜“**  
   å¯¹äºé‡æ–°è´­ä¹°çš„äº¤æ˜“ï¼Œå¼€å‘è€…éœ€è¦åœ¨ä¸‰å¤©å†…ç¡®è®¤ï¼Œå¦åˆ™äº¤æ˜“å°†è¢« Play å–æ¶ˆã€‚

2. **ä½¿ç”¨ Google Developer API**  
   é€šè¿‡ API çš„ `expiryTimeMillis` å­—æ®µè·å–è®¢é˜…çš„åˆ°æœŸæ—¶é—´ï¼Œç¡®ä¿æ•°æ®å‡†ç¡®ã€‚

3. **å‚è€ƒå®˜æ–¹æ–‡æ¡£**  
   - [é”€å”®è®¢é˜…](https://developer.android.google.cn/google/play/billing/subs)  
   - [å®æ—¶å¼€å‘è€…é€šçŸ¥å‚è€ƒæŒ‡å—](https://developer.android.google.cn/google/play/billing/rtdn-reference)  
   - [Google Developer API çš„è®¢é˜…æ¥å£](https://developers.google.google.cn/android-publisher/api-ref/rest/v3/purchases.subions/get)

## æ€»ç»“

æ¢å¤è®¢é˜…å’Œé‡æ–°è®¢é˜…æ˜¯ Play Billing ä¸­ä¸¤ä¸ªé‡è¦ä½†å®¹æ˜“æ··æ·†çš„åŠŸèƒ½ã€‚å¼€å‘è€…éœ€è¦æ ¹æ®ç”¨æˆ·çš„å…·ä½“æ“ä½œåœºæ™¯ï¼Œæ­£ç¡®å¤„ç† `purchaseToken` å’Œè®¢é˜…çŠ¶æ€ã€‚å¦‚æœæ‚¨å¯¹è®¢é˜…è¿˜æœ‰ä»»ä½•ç–‘é—®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚

---

ğŸ‘‰ [WildCard | ä¸€åˆ†é’Ÿæ³¨å†Œï¼Œè½»æ¾è®¢é˜…æµ·å¤–çº¿ä¸ŠæœåŠ¡](https://bit.ly/bewildcard)